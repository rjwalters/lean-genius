{
  "id": "erdos-1069",
  "title": "Erdős Problem #1069: Szemerédi-Trotter Theorem on k-Rich Lines",
  "slug": "erdos-1069",
  "description": "Given n points in ℝ², the number of k-rich lines (containing ≥k points) is O(n²/k³) for k ≤ √n. Proved by Szemerédi-Trotter (1983).",
  "meta": {
    "author": "Szemerédi-Trotter (1983)",
    "sourceUrl": "https://erdosproblems.com/1069",
    "date": "1983",
    "status": "axiom",
    "proofRepoPath": "Proofs/Erdos1069Problem.lean",
    "tags": [
      "erdos",
      "incidence-geometry",
      "szemeredi-trotter",
      "combinatorial-geometry",
      "k-rich-lines"
    ],
    "badge": "axiom",
    "sorries": 8,
    "erdosNumber": 1069,
    "erdosUrl": "https://erdosproblems.com/1069",
    "erdosProblemStatus": "solved"
  },
  "overview": {
    "historicalContext": "This problem was conjectured by Erdős, Croft, and Purdy and described by Erdős in his 1987 paper 'Some combinatorial and metric problems in geometry'. The result follows from the celebrated Szemerédi-Trotter theorem (1983), which bounds the number of incidences between points and lines in the plane. This theorem is a cornerstone of incidence geometry and has applications throughout combinatorics and computational geometry.",
    "problemStatement": "Given any n points in ℝ², the number of k-rich lines (lines containing ≥ k of the points) is O(n²/k³), provided k ≤ √n. The exact constant is unknown. For k = √n, lattice points show there can be ≥ (2+o(1))√n many √n-rich lines; Sah (1987) improved this to (3+o(1))√n.",
    "proofStrategy": "The formalization defines points, lines, and incidences in ℝ². The Szemerédi-Trotter theorem bounds total incidences I(P,L) ≤ O(|P|^(2/3)|L|^(2/3) + |P| + |L|). The k-rich lines bound follows: if m lines each have ≥ k incidences, then mk ≤ I(P,L), giving m ≤ O(n^(2/3)m^(2/3)/k + n/k), which solves to m ≤ O(n²/k³).",
    "keyInsights": [
      "A k-rich line contributes at least k to the total incidence count",
      "Szemerédi-Trotter's incidence bound is tight up to constants",
      "The dyadic decomposition technique partitions lines by incidence count",
      "Lattice points provide lower bound constructions",
      "Point-line duality gives equivalent dual formulations"
    ]
  },
  "sections": [
    {
      "id": "basic-definitions",
      "title": "Basic Definitions",
      "summary": "Point, Line, onLine, pointsOnLine, incidenceCount definitions",
      "startLine": 37,
      "endLine": 63
    },
    {
      "id": "k-rich-lines",
      "title": "k-Rich Lines",
      "summary": "isKRich, kRichLines, numKRichLines definitions",
      "startLine": 65,
      "endLine": 81
    },
    {
      "id": "total-incidences",
      "title": "Total Incidences",
      "summary": "totalIncidences, incidencePairs, incidences_eq theorem",
      "startLine": 83,
      "endLine": 100
    },
    {
      "id": "szemeredi-trotter",
      "title": "The Szemerédi-Trotter Theorem",
      "summary": "szTrBound function, szemeredi_trotter axiom, optimality",
      "startLine": 102,
      "endLine": 119
    },
    {
      "id": "k-rich-bound",
      "title": "The k-Rich Lines Bound",
      "summary": "kRichBound, kRich_incidences_lower, kRich_bound, erdos_1069",
      "startLine": 121,
      "endLine": 145
    },
    {
      "id": "proof-strategy",
      "title": "The Proof Strategy",
      "summary": "dyadicLines decomposition, dyadic_bound, dyadic_szTr theorems",
      "startLine": 147,
      "endLine": 167
    },
    {
      "id": "lower-bounds",
      "title": "Lower Bound Constructions",
      "summary": "latticePoints, lattice_lower_bound, sah_construction",
      "startLine": 169,
      "endLine": 191
    },
    {
      "id": "special-cases",
      "title": "Special Cases",
      "summary": "case_k2, case_sqrt_n, large_k_bound theorems",
      "startLine": 193,
      "endLine": 214
    },
    {
      "id": "duality",
      "title": "Connection to Point-Line Duality",
      "summary": "dual_kRich_bound, duality_preserves_incidences",
      "startLine": 216,
      "endLine": 230
    },
    {
      "id": "generalizations",
      "title": "Generalizations",
      "summary": "higher_dim_incidences, finite_field_version",
      "startLine": 232,
      "endLine": 247
    },
    {
      "id": "summary",
      "title": "Summary",
      "summary": "erdos_1069_summary and erdos_1069_answer",
      "startLine": 249,
      "endLine": 265
    }
  ],
  "conclusion": {
    "summary": "Erdős Problem #1069 was solved by the Szemerédi-Trotter theorem (1983). The number of k-rich lines through n points is O(n²/k³) when k ≤ √n. The bound is nearly tight: lattice point constructions give Ω(√n) many √n-rich lines, and Sah improved this lower bound constant.",
    "implications": "The Szemerédi-Trotter theorem is fundamental to incidence geometry and has numerous applications in sum-product theory, the Erdős distinct distances problem, and computational geometry algorithms for line arrangement problems.",
    "openQuestions": [
      "What is the optimal constant in the k-rich lines bound?",
      "Can the gap between upper and lower bounds for √n-rich lines be closed?",
      "What are the tight bounds over finite fields?",
      "How do the bounds generalize to curves other than lines?"
    ]
  }
}
