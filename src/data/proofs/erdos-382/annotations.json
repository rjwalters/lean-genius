[
  {
    "id": "ann-e382-header",
    "proofId": "erdos-382",
    "type": "concept",
    "range": { "startLine": 1, "endLine": 29 },
    "title": "Problem Overview",
    "content": "Erdős Problem #382 studies products of consecutive integers u·(u+1)·...·v and asks about intervals where the largest prime divisor has exponent at least 2. This means p² divides the product for the largest prime p, which forces p ≤ √v — equivalently, the interval [u,v] contains no primes larger than √v. Two open questions: does v−u grow subpolynomially (Question 1), and can v−u be arbitrarily large (Question 2)?",
    "mathContext": "From Erdős-Graham [ErGr80]. The condition that the largest prime dividing ∏_{m=u}^{v} m has exponent ≥ 2 is equivalent to no prime p > √v lying in [u,v]. Connected to prime gap theory and Cramér's conjecture.",
    "significance": "critical",
    "relatedConcepts": ["prime gaps", "factorization", "Cramér's conjecture", "Ramachandra's bound"]
  },
  {
    "id": "ann-e382-prodinterval",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 46, "endLine": 54 },
    "title": "Product of an Interval",
    "content": "prodInterval(u, v) computes the product of all integers from u to v inclusive: u·(u+1)·...·v. This equals v!/(u−1)! and is defined using Finset.Icc (closed-closed interval) and Finset.prod from Mathlib's BigOperators library.",
    "mathContext": "prodInterval u v = ∏ m ∈ Finset.Icc u v, m. This is the fundamental object whose prime factorization determines the Erdős-Graham condition.",
    "significance": "critical",
    "relatedConcepts": ["factorial", "Finset.Icc", "Finset.prod", "BigOperators"]
  },
  {
    "id": "ann-e382-prodinterval-props",
    "proofId": "erdos-382",
    "type": "theorem",
    "range": { "startLine": 56, "endLine": 63 },
    "title": "Interval Product Properties",
    "content": "Two properties of prodInterval: (1) prodInterval_singleton proves that prodInterval(n,n) = n using simp on Finset.Icc_self, a genuine Lean proof. (2) prodInterval_factorial states that prodInterval(1,n) = n!, axiomatized because Mathlib's factorial API does not directly connect to Finset products over Icc.",
    "mathContext": "prodInterval_singleton: prodInterval n n = n (proved by simp). prodInterval_factorial: prodInterval 1 n = n! (axiom — requires connecting Finset.prod over Icc to Nat.factorial).",
    "significance": "key",
    "relatedConcepts": ["Finset.Icc_self", "Nat.factorial", "simp tactic"]
  },
  {
    "id": "ann-e382-largest-prime",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 65, "endLine": 76 },
    "title": "Largest Prime Divisor",
    "content": "largestPrimeDivisor(n) returns the largest prime that divides n, or 0 if n ≤ 1. It works by taking the maximum of n.primeFactorsList — the list of prime factors with multiplicity from Mathlib. This is noncomputable because it relies on classical decidability.",
    "mathContext": "largestPrimeDivisor n = (n.primeFactorsList).maximum?.getD 0 if n > 1, else 0. Marked noncomputable due to dependence on classical logic in the prime factorization.",
    "significance": "critical",
    "relatedConcepts": ["primeFactorsList", "List.maximum?", "noncomputable"]
  },
  {
    "id": "ann-e382-largest-prime-axioms",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 77, "endLine": 87 },
    "title": "Largest Prime Divisor Axioms",
    "content": "Three axioms characterize largestPrimeDivisor: (1) it divides n, (2) it is prime when n > 1, and (3) every prime divisor of n is at most largestPrimeDivisor(n). These are axiomatized because proving them requires careful manipulation of primeFactorsList and List.maximum? that is technically straightforward but verbose in Lean.",
    "mathContext": "largestPrimeDivisor_dvd: largestPrimeDivisor n ∣ n. largestPrimeDivisor_prime: (largestPrimeDivisor n).Prime. prime_le_largestPrimeDivisor: p.Prime → p ∣ n → p ≤ largestPrimeDivisor n.",
    "significance": "key",
    "relatedConcepts": ["divisibility", "prime maximality", "primeFactorsList properties"]
  },
  {
    "id": "ann-e382-exponent",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 89, "endLine": 100 },
    "title": "P-adic Valuation",
    "content": "exponent(p, n) is the p-adic valuation of n — the exponent of prime p in the factorization of n. It wraps Mathlib's Nat.factorization, which returns a Finsupp mapping each prime to its exponent. exponentInProduct(p, u, v) specializes this to the product of an interval.",
    "mathContext": "exponent p n = n.factorization p (Nat.factorization from Mathlib). exponentInProduct p u v = exponent p (prodInterval u v). The p-adic valuation is the fundamental tool for analyzing prime power structure.",
    "significance": "critical",
    "relatedConcepts": ["p-adic valuation", "Nat.factorization", "Finsupp"]
  },
  {
    "id": "ann-e382-exponent-sum",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 102, "endLine": 104 },
    "title": "Exponent Sum Decomposition",
    "content": "The exponent of p in a product of integers equals the sum of individual exponents: v_p(∏ m) = Σ v_p(m). This is the key property of the p-adic valuation — it converts products to sums. Axiomatized because it requires Nat.factorization_prod from Mathlib with careful handling of zero terms.",
    "mathContext": "exponentInProduct_sum: exponentInProduct p u v = ∑ m ∈ Finset.Icc u v, exponent p m. This follows from the completely additive nature of the p-adic valuation.",
    "significance": "key",
    "relatedConcepts": ["additive valuation", "Nat.factorization_prod", "completely multiplicative"]
  },
  {
    "id": "ann-e382-condition",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 108, "endLine": 118 },
    "title": "The Erdős-Graham Condition",
    "content": "satisfiesCondition(u, v) formalizes the problem's core constraint: u ≤ v, u > 0, and the largest prime dividing the product u·(u+1)·...·v has exponent at least 2 in that product. This is the central predicate around which both open questions are formulated.",
    "mathContext": "satisfiesCondition u v ≡ u ≤ v ∧ u > 0 ∧ exponent(largestPrimeDivisor(prodInterval u v), prodInterval u v) ≥ 2. The condition means p² | (prodInterval u v) for the largest prime p dividing the product.",
    "significance": "critical",
    "relatedConcepts": ["prime power", "interval product", "exponent condition"]
  },
  {
    "id": "ann-e382-structural",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 120, "endLine": 130 },
    "title": "Structural Axioms",
    "content": "Two structural results: (1) If the largest prime p in [u,v] satisfies p² > v, then p has exponent exactly 1 (it appears once in the product and its square exceeds v). (2) For exponent ≥ 2, some multiple of p² must lie in [u,v]. These capture the combinatorial heart of the problem.",
    "mathContext": "largest_prime_exp_one: p largest prime, p² > v ⟹ exponent = 1. exp_ge_two_needs_square: exponent ≥ 2 ⟹ ∃ k, p² | k ∧ u ≤ k ≤ v. These structural constraints link exponent conditions to interval geometry.",
    "significance": "key",
    "relatedConcepts": ["prime squares", "interval containment", "exponent bounds"]
  },
  {
    "id": "ann-e382-q1",
    "proofId": "erdos-382",
    "type": "concept",
    "range": { "startLine": 134, "endLine": 147 },
    "title": "Question 1: Subpolynomial Growth (OPEN)",
    "content": "The first open question: Is v − u = v^o(1)? Formally, for every ε > 0, there exists V such that for all u,v with v ≥ V satisfying the condition, (v−u) < v^ε. This asks whether the interval length grows slower than any fixed power of v. The axiom erdos_382_q1 asserts the answer is YES, but this is unproven.",
    "mathContext": "question1: ∀ ε > 0, ∃ V, ∀ u v ≥ V, satisfiesCondition u v → (v−u : ℝ) < v^ε. erdos_382_q1: question1 (axiom — conjectured true). Under Cramér's conjecture, this follows.",
    "significance": "critical",
    "relatedConcepts": ["subpolynomial growth", "o(1) notation", "Cramér's conjecture"]
  },
  {
    "id": "ann-e382-q2",
    "proofId": "erdos-382",
    "type": "concept",
    "range": { "startLine": 149, "endLine": 159 },
    "title": "Question 2: Unbounded Length (OPEN)",
    "content": "The second open question: Can v − u be arbitrarily large? Formally, for every L, there exist u,v satisfying the condition with v − u > L. Cambie's heuristic analysis suggests the answer is YES — near squares of large primes, the intervals [u,v] with no prime > √v can be long. The axiom erdos_382_q2_heuristic asserts YES.",
    "mathContext": "question2: ∀ L, ∃ u v, satisfiesCondition u v ∧ v − u > L. erdos_382_q2_heuristic: question2 (axiom — heuristically supported). Note Questions 1 and 2 are compatible: v−u can grow but slower than v^ε.",
    "significance": "critical",
    "relatedConcepts": ["unbounded growth", "prime squares", "heuristic arguments"]
  },
  {
    "id": "ann-e382-ramachandra",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 161, "endLine": 173 },
    "title": "Ramachandra's Bound",
    "content": "The best known unconditional result: v − u ≤ v^{1/2 + o(1)}. For any ε > 0 and sufficiently large v, intervals [u,v] satisfying the condition have v − u ≤ v^{1/2+ε}. This uses techniques from the distribution of primes in short intervals. It shows the interval length is at most roughly √v.",
    "mathContext": "ramachandra_bound: ∀ ε > 0, ∃ V, ∀ u v ≥ V, satisfiesCondition u v → (v−u : ℝ) ≤ v^{1/2+ε}. Axiomatized: requires deep analytic number theory (zero-free regions, sieve methods).",
    "significance": "critical",
    "relatedConcepts": ["short intervals", "prime distribution", "analytic number theory"]
  },
  {
    "id": "ann-e382-cramer-def",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 175, "endLine": 188 },
    "title": "Cramér's Conjecture",
    "content": "Cramér's conjecture (1936): the gap between consecutive primes p_n and p_{n+1} is O((log p_n)²). Formally, there exists C > 0 such that for all n, p_{n+1} − p_n ≤ C·(log p_n)². This is one of the most important open conjectures in number theory. If true, it prevents long prime-free intervals.",
    "mathContext": "cramersConjecture: ∃ C > 0, ∀ n > 0, (Nat.nth Prime (n+1) − Nat.nth Prime n : ℝ) ≤ C·(log(Nat.nth Prime n))². Uses Nat.nth to enumerate primes.",
    "significance": "key",
    "relatedConcepts": ["prime gaps", "Cramér's conjecture", "Nat.nth"]
  },
  {
    "id": "ann-e382-cramer-implies",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 190, "endLine": 191 },
    "title": "Cramér Implies Question 1",
    "content": "If Cramér's conjecture holds, then Question 1 has answer YES. The reasoning: Cramér's conjecture bounds prime gaps by O((log p)²), so any interval of length v^ε (for ε > 0) contains a prime for large v. This means intervals [u,v] satisfying the Erdős-Graham condition (no prime > √v) must have v−u = v^o(1).",
    "mathContext": "cramer_implies_q1: cramersConjecture → question1. Axiomatized: the deduction uses properties of prime-counting functions and logarithmic estimates.",
    "significance": "key",
    "relatedConcepts": ["conditional results", "prime-free intervals", "logarithmic bounds"]
  },
  {
    "id": "ann-e382-example",
    "proofId": "erdos-382",
    "type": "theorem",
    "range": { "startLine": 195, "endLine": 198 },
    "title": "Concrete Example: [2,4]",
    "content": "A verified computational example: prodInterval(2, 4) = 2·3·4 = 24. The proof uses native_decide, which evaluates the expression at compile time. Note: 24 = 2³·3, so the largest prime is 3 with exponent 1 — this interval does NOT satisfy the Erdős-Graham condition.",
    "mathContext": "example: prodInterval 2 4 = 24 (proved by native_decide). 24 = 2³·3, largest prime divisor is 3, exponent of 3 is 1 < 2.",
    "significance": "supporting",
    "relatedConcepts": ["native_decide", "computational verification", "counterexample"]
  },
  {
    "id": "ann-e382-no-prime-upper",
    "proofId": "erdos-382",
    "type": "axiom",
    "range": { "startLine": 203, "endLine": 206 },
    "title": "No Large Primes Under Condition",
    "content": "If [u,v] satisfies the Erdős-Graham condition, then there is no prime p with √v < p ≤ v. This is the contrapositive of the structural result: such a prime p would have p² > v, forcing exponent 1, contradicting the condition requiring exponent ≥ 2.",
    "mathContext": "no_prime_in_upper_half: satisfiesCondition u v → p.Prime → p > Nat.sqrt v → p ≤ v → False. This is the key structural consequence of the condition.",
    "significance": "key",
    "relatedConcepts": ["Nat.sqrt", "contrapositive", "prime-free intervals"]
  },
  {
    "id": "ann-e382-primefree",
    "proofId": "erdos-382",
    "type": "definition",
    "range": { "startLine": 209, "endLine": 224 },
    "title": "Prime-Free Interval Perspective",
    "content": "noPrimeLargerThanSqrt(u, v) captures the equivalent formulation: all primes in [u,v] are at most √v. The axiom condition_iff_no_large_prime establishes this equivalence with satisfiesCondition. This reformulates Problem 382 as a question about the existence and length of prime-free intervals above √v.",
    "mathContext": "noPrimeLargerThanSqrt u v ≡ ∀ p prime, u ≤ p → p ≤ v → p ≤ Nat.sqrt v. condition_iff_no_large_prime: satisfiesCondition u v ↔ (u ≤ v ∧ u > 0 ∧ noPrimeLargerThanSqrt u v).",
    "significance": "key",
    "relatedConcepts": ["prime-free intervals", "equivalent formulations", "Nat.sqrt"]
  },
  {
    "id": "ann-e382-summary",
    "proofId": "erdos-382",
    "type": "theorem",
    "range": { "startLine": 229, "endLine": 254 },
    "title": "Summary Theorem",
    "content": "erdos_382_summary combines the three main known results into a single theorem: (1) Ramachandra's bound holds (from ramachandra_bound axiom), (2) Cramér's conjecture implies Question 1 (from cramer_implies_q1 axiom), and (3) both questions are formally stated (trivially True). The proof is a direct triple ⟨ramachandra_bound, cramer_implies_q1, trivial⟩.",
    "mathContext": "erdos_382_summary: (Ramachandra bound) ∧ (Cramér → Q1) ∧ True. Proof: ⟨ramachandra_bound, cramer_implies_q1, trivial⟩. This is a genuine Lean proof combining the axiomatized results.",
    "significance": "key",
    "relatedConcepts": ["summary theorem", "anonymous constructor", "open problem"]
  },
  {
    "id": "ann-e382-consistent",
    "proofId": "erdos-382",
    "type": "theorem",
    "range": { "startLine": 256, "endLine": 264 },
    "title": "Ramachandra Bound Consistency",
    "content": "ramachandra_consistent_with_questions demonstrates that the Ramachandra bound v−u ≤ v^{1/2+ε} is logically consistent with both open questions. The proof is the identity function: the bound itself is the conclusion, showing it does not contradict either subpolynomial growth (Question 1) or unbounded length (Question 2). Both questions remain OPEN.",
    "mathContext": "ramachandra_consistent_with_questions: (Ramachandra bound) → (Ramachandra bound). Proof: id. This trivial implication highlights that the known bound leaves both questions open — it constrains but does not resolve.",
    "significance": "supporting",
    "relatedConcepts": ["consistency", "open problem", "Ramachandra's bound"]
  }
]
