[
  {
    "id": "ann-e1086-point2d",
    "proofId": "erdos-1086",
    "range": { "startLine": 44, "endLine": 51 },
    "type": "definition",
    "title": "Point2D and Coordinates",
    "content": "`Point2D` is a point in the Euclidean plane $\\mathbb{R}^2$, defined as `EuclideanSpace ℝ (Fin 2)`. Coordinate accessors `Point2D.x` and `Point2D.y` extract the two components via indices 0 and 1.",
    "mathContext": "Using Mathlib's `EuclideanSpace ℝ (Fin 2)` provides the full inner product space structure on $\\mathbb{R}^2$, including distance, norm, and angle. The coordinate accessors are simple projections `p 0` and `p 1`, which are used in the shoelace formula for triangle area.",
    "relatedConcepts": ["EuclideanSpace", "Fin", "inner product space"],
    "significance": "key"
  },
  {
    "id": "ann-e1086-trianglearea",
    "proofId": "erdos-1086",
    "range": { "startLine": 53, "endLine": 56 },
    "type": "definition",
    "title": "Triangle Area (Shoelace Formula)",
    "content": "`triangleArea A B C` computes $\\frac{1}{2}|x_A(y_B - y_C) + x_B(y_C - y_A) + x_C(y_A - y_B)|$ — the shoelace formula for the area of triangle $ABC$. The absolute value ensures non-negative area regardless of vertex orientation.",
    "mathContext": "The shoelace formula computes signed area as half the determinant $\\begin{vmatrix} x_A - x_C & x_B - x_C \\\\ y_A - y_C & y_B - y_C \\end{vmatrix}$. Taking the absolute value gives the unsigned area. This formula is exact (no approximation) and works for all triangles including degenerate ones (area 0 for collinear points).",
    "relatedConcepts": ["determinant", "abs", "Real.div", "signed area"],
    "significance": "critical"
  },
  {
    "id": "ann-e1086-triangle",
    "proofId": "erdos-1086",
    "range": { "startLine": 58, "endLine": 69 },
    "type": "definition",
    "title": "Triangle Structure",
    "content": "The `Triangle` structure bundles three points $A, B, C$ with proofs that all three are distinct ($A \\neq B$, $B \\neq C$, $C \\neq A$). Its `area` method applies `triangleArea` to the three vertices.",
    "mathContext": "The distinctness conditions ensure a non-degenerate triangle (though the area could still be 0 if points are collinear). The three pairwise inequalities are the minimum needed — they don't prevent collinearity, only coincidence.",
    "relatedConcepts": ["Structure", "Ne", "triangleArea"],
    "significance": "supporting"
  },
  {
    "id": "ann-e1086-counting",
    "proofId": "erdos-1086",
    "range": { "startLine": 77, "endLine": 91 },
    "type": "definition",
    "title": "Counting Function g(n)",
    "content": "`countTrianglesWithArea S α` counts unordered triples from $S$ with area $\\alpha$, using `Finset.powersetCard 3` to enumerate all 3-element subsets. `maxTrianglesWithSameArea S` takes the supremum over all areas $\\alpha$. `g n` takes the supremum over all $n$-point sets $S$.",
    "mathContext": "The definition uses two nested suprema: first over areas (for a fixed point set), then over point sets (of the right cardinality). The `sSup` operation on $\\mathbb{N}$ requires careful handling — the set of areas realized by a finite point set is finite, so the inner supremum is well-defined. The outer supremum over all $n$-point sets in $\\mathbb{R}^2$ is unbounded a priori but is axiomatically bounded by the known upper bounds.",
    "relatedConcepts": ["Finset.powersetCard", "Finset.filter", "sSup", "Finset.card"],
    "significance": "critical"
  },
  {
    "id": "ann-e1086-lower",
    "proofId": "erdos-1086",
    "range": { "startLine": 97, "endLine": 99 },
    "type": "theorem",
    "title": "Lower Bound: n² log log n (Erdős-Purdy 1971)",
    "content": "`lower_bound_erdos_purdy`: $\\exists C > 0$ such that $g(n) \\geq C \\cdot n^2 \\cdot \\log \\log n$ for $n \\geq 16$. This is the best known lower bound and uses a probabilistic construction.",
    "mathContext": "The lower bound construction places points on a carefully chosen set to maximize equal-area triangles. The $\\log \\log n$ factor arises from a Ramsey-theoretic argument about arithmetic progressions. The threshold $n \\geq 16$ ensures $\\log \\log n > 0$. The $n^2$ factor is natural since there are $\\binom{n}{3} = O(n^3)$ triangles total and each area class contributes at most $O(n^2)$ in typical configurations.",
    "relatedConcepts": ["Real.log", "Nat.cast", "existential quantification", "Ramsey theory"],
    "significance": "critical"
  },
  {
    "id": "ann-e1086-upper-bounds",
    "proofId": "erdos-1086",
    "range": { "startLine": 101, "endLine": 107 },
    "type": "theorem",
    "title": "Upper Bounds: n^{5/2} to n^{20/9}",
    "content": "The upper bound improved from $g(n) \\ll n^{5/2}$ (Erdős-Purdy 1971) to $g(n) \\ll n^{20/9}$ (Raz-Sharir 2017). The exponent decreased: $5/2 = 2.5 \\to 20/9 \\approx 2.222$, approaching but not reaching the conjectured quadratic.",
    "mathContext": "The upper bounds use the reduction to point-curve incidences. For area $\\alpha$ and base $(A,B)$, the third vertex $C$ lies on a line parallel to $AB$ at distance $2\\alpha/|AB|$. This gives $O(n^2)$ lines, and the Szemerédi-Trotter theorem bounds point-line incidences. The Raz-Sharir improvement uses a refined incidence bound for algebraic curves (not just lines).",
    "relatedConcepts": ["Real.rpow", "incidence_reduction", "szemeredi_trotter_bound"],
    "significance": "critical"
  },
  {
    "id": "ann-e1086-conjecture",
    "proofId": "erdos-1086",
    "range": { "startLine": 112, "endLine": 118 },
    "type": "definition",
    "title": "Erdős-Purdy Conjecture",
    "content": "`erdos_purdy_conjecture` states $g(n) = \\Theta(n^2 (\\log n)^\\alpha)$ for some $\\alpha > 0$: the truth is believed to be quadratic with a polylogarithmic correction. This is formalized as the existence of $\\alpha > 0$ with matching upper and lower bounds.",
    "mathContext": "The conjecture predicts that the lower bound $n^2 \\log \\log n$ is closer to the truth than the upper bound $n^{20/9}$. The polylogarithmic correction $(\\log n)^\\alpha$ generalizes the $\\log \\log n$ in the lower bound. If true, this would be analogous to the Erdős unit distance conjecture, where grid-like constructions are near-extremal.",
    "relatedConcepts": ["Real.log", "Real.rpow", "Theta notation", "extremal combinatorics"],
    "significance": "key"
  },
  {
    "id": "ann-e1086-gdim",
    "proofId": "erdos-1086",
    "range": { "startLine": 126, "endLine": 135 },
    "type": "definition",
    "title": "Higher-Dimensional Generalization g_d^r(n)",
    "content": "`g_dim d r n` is the maximum number of $r$-simplices of the same volume from $n$ points in $\\mathbb{R}^d$. Axiomatized since the definition involves a supremum over all point configurations. `g2_is_g` states $g_2^2(n) = g(n)$, connecting to the original problem.",
    "mathContext": "The generalization to $r$-simplices in $\\mathbb{R}^d$ reveals dimension-dependent behavior. The critical case is $d = 2r$: the Oppenheim-Lenz construction achieves $g_{2r}^r(n) \\geq c \\cdot n^{r+1}$ using a product construction. For $d < 2r$, the bounds are suboptimal; for $d > 2r$, higher-dimensional freedom allows more equal-volume simplices.",
    "relatedConcepts": ["simplex", "volume", "dimension", "g2_is_g"],
    "significance": "key"
  },
  {
    "id": "ann-e1086-higherdim-bounds",
    "proofId": "erdos-1086",
    "range": { "startLine": 137, "endLine": 161 },
    "type": "theorem",
    "title": "Higher-Dimensional Bounds",
    "content": "Various dimension-specific results:\n- $g_3^2(n) \\ll n^{8/3}$ (Erdős-Purdy) improved to $n^{2.4286}$ (DST 2009)\n- $g_6^2(n) \\gg n^3$ (Erdős-Purdy)\n- $g_4^2(n) \\leq g_5^2(n) \\ll n^{3-c}$ (Purdy 1974)\n- Oppenheim-Lenz: $g_{2k+2}^k(n) \\geq c \\cdot n^{k+1}$\n- Conjecture: $g_{2k+2}^k(n) = \\Theta(n^{k+1})$",
    "mathContext": "The Oppenheim-Lenz construction places $n$ points on $k+1$ curves in $\\mathbb{R}^{2k+2}$ arranged so that many $(k+1)$-tuples span simplices of the same volume. The conjecture that this is optimal would generalize the 2D Erdős-Purdy conjecture. The Purdy bound $g_5^2(n) \\ll n^{3-c}$ is significant because $3$ is the 'obvious' exponent for 5D.",
    "relatedConcepts": ["g_dim", "oppenheim_lenz_construction", "erdos_purdy_conjecture_high_dim", "Real.rpow"],
    "significance": "key"
  },
  {
    "id": "ann-e1086-examples",
    "proofId": "erdos-1086",
    "range": { "startLine": 167, "endLine": 179 },
    "type": "theorem",
    "title": "Simple Examples",
    "content": "`three_points_one_triangle`: $g(3) = 1$ (3 points determine exactly 1 triangle). `collinear_degenerate`: collinear points produce no positive-area triangles. `grid_lower_bound`: a $\\sqrt{n} \\times \\sqrt{n}$ grid gives $g(n) \\geq n^2/8$.",
    "mathContext": "The grid lower bound is the simplest construction showing $g(n) = \\Omega(n^2)$. In a $k \\times k$ grid with $n = k^2$ points, many triples of grid points form triangles of the same area because the shoelace formula produces values in $\\frac{1}{2}\\mathbb{Z}$. The factor $1/8$ is a conservative lower bound; the actual count is higher.",
    "relatedConcepts": ["three_points_one_triangle", "grid_lower_bound", "collinear_degenerate"],
    "significance": "supporting"
  },
  {
    "id": "ann-e1086-incidence",
    "proofId": "erdos-1086",
    "range": { "startLine": 185, "endLine": 200 },
    "type": "theorem",
    "title": "Incidence Geometry Connection",
    "content": "`incidence_reduction`: the number of triangles of area $\\alpha$ is bounded by the number of base edges $\\binom{n}{2}$ times a factor from point-line incidences. `szemeredi_trotter_bound`: the Szemerédi-Trotter theorem bounds incidences between $n$ points and $m$ lines to $O(n^{2/3}m^{2/3} + n + m)$.",
    "mathContext": "The reduction to incidences works as follows: fix a base edge $(A,B)$ with $|AB| = d$. The set of points $C$ forming a triangle of area $\\alpha$ lies on two lines parallel to $AB$ at distance $2\\alpha/d$. Summing over all $\\binom{n}{2}$ base edges gives $O(n^2)$ lines. The Szemerédi-Trotter theorem then bounds the total incidences, yielding the upper bound on $g(n)$. The Raz-Sharir improvement uses a more refined algebraic curve incidence bound.",
    "relatedConcepts": ["incidence_reduction", "szemeredi_trotter_bound", "Finset.card", "point-line incidence"],
    "significance": "key"
  },
  {
    "id": "ann-e1086-statement",
    "proofId": "erdos-1086",
    "range": { "startLine": 206, "endLine": 213 },
    "type": "theorem",
    "title": "Main Statement",
    "content": "`erdos_1086_statement` is a **genuine theorem**: for $n \\geq 16$, both the lower bound $n^2 \\log \\log n \\ll g(n)$ and the upper bound $g(n) \\ll n^{20/9}$ hold simultaneously. The proof applies the two axiomatized bounds directly.",
    "mathContext": "The proof uses anonymous constructor `⟨..., ...⟩` to combine the lower bound (from `lower_bound_erdos_purdy n hn`) and upper bound (from `upper_bound_raz_sharir_2017 n (by omega)`). The `by omega` discharge handles the weakening from $n \\geq 16$ to $n \\geq 2$ needed by the upper bound axiom.",
    "relatedConcepts": ["lower_bound_erdos_purdy", "upper_bound_raz_sharir_2017", "And.intro", "omega"],
    "significance": "critical"
  },
  {
    "id": "ann-e1086-summary",
    "proofId": "erdos-1086",
    "range": { "startLine": 221, "endLine": 233 },
    "type": "theorem",
    "title": "Summary Theorem",
    "content": "`erdos_1086_summary` is a **genuine theorem** combining three results for $n \\geq 16$:\n1. Lower bound: $n^2 \\log \\log n \\ll g(n)$\n2. Upper bound: $g(n) \\ll n^{20/9}$\n3. 3D bound: $g_3^2(n) \\ll n^{2.4286}$\n\nThe proof directly applies the three axiomatized bounds.",
    "mathContext": "The three-part conjunction captures the state of knowledge across dimensions. Including the 3D bound alongside the 2D bounds illustrates the higher-dimensional generalization. The proof is a direct tuple construction from the three component axioms, with `by omega` handling hypothesis weakening.",
    "relatedConcepts": ["lower_bound_erdos_purdy", "upper_bound_raz_sharir_2017", "bound_g3_2_dst", "And.intro"],
    "significance": "critical"
  }
]
