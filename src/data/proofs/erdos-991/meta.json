{
  "id": "erdos-991",
  "title": "Erdős Problem #991: Discrepancy of Optimal Logarithmic Energy Points",
  "slug": "erdos-991",
  "description": "Do optimal logarithmic energy point configurations on S² have small spherical cap discrepancy? YES, proved via classical potential theory with quantitative bounds by Brauchart (2008) and Marzo-Mas (2021).",
  "meta": {
    "author": "Brauchart (2008 bound), Marzo-Mas (2021 improvement)",
    "sourceUrl": "https://erdosproblems.com/991",
    "date": "2008",
    "status": "complete",
    "proofRepoPath": "Proofs/Erdos991Problem.lean",
    "tags": [
      "erdos",
      "discrepancy-theory",
      "potential-theory",
      "sphere",
      "logarithmic-energy",
      "fekete-points",
      "solved"
    ],
    "badge": "axiom",
    "sorries": 1,
    "erdosNumber": 991,
    "erdosUrl": "https://erdosproblems.com/991",
    "erdosProblemStatus": "solved",
    "dateAdded": "2026-01-18",
    "mathlib_version": "4.15.0",
    "mathlibDependencies": [
      {
        "theorem": "Real.sqrt",
        "description": "Square root function on reals",
        "module": "Mathlib.Analysis.SpecialFunctions.Pow.Real"
      },
      {
        "theorem": "Real.log",
        "description": "Natural logarithm function",
        "module": "Mathlib.Analysis.SpecialFunctions.Log.Basic"
      },
      {
        "theorem": "Real.rpow",
        "description": "Real power function for exponents",
        "module": "Mathlib.Analysis.SpecialFunctions.Pow.Real"
      },
      {
        "theorem": "Finset.sum",
        "description": "Sum over finite sets",
        "module": "Mathlib.Algebra.BigOperators.Group.Finset.Basic"
      }
    ],
    "originalContributions": [
      "UnitSphere definition: points in R³ at unit distance from origin",
      "sphereDist: chordal distance between points on sphere",
      "logEnergy: logarithmic energy of point configuration",
      "IsOptimalConfig: predicate for energy-minimizing configurations",
      "SphericalCap: cap defined by center and angular radius",
      "normalizedCapArea: cap area normalized to [0,1]",
      "capCount: count of points in a cap",
      "HasSmallDiscrepancy: o(n) discrepancy property",
      "brauchart_bound axiom: O(n^{3/4}) discrepancy bound",
      "marzo_mas_bound axiom: improved O(n^{2/3}) bound",
      "erdos_991 theorem: main qualitative result",
      "FeketePoints: optimal configurations for n points",
      "rieszEnergy: generalized s-energy",
      "hemisphere_approx: special case for half-sphere",
      "improvement_factor: comparing bounds"
    ]
  },
  "overview": {
    "historicalContext": "**Erdős Problem #991**\n\nThis problem concerns the distribution of optimal point configurations on the sphere. The setup involves logarithmic energy minimization, a classical topic in potential theory with applications to polynomial interpolation and numerical integration on spheres.\n\n**Key History:**\n- The qualitative result (discrepancy is o(n)) follows from classical potential theory, though the exact attribution is unclear\n- Brauchart (2008): First quantitative bound of O(n^{3/4})\n- Wolff (unpublished): Improved to O(n^{2/3})\n- Marzo-Mas (2021): Published proof of O(n^{2/3}) as a special case of a more general result about Riesz energy on manifolds\n\n**Mathematical Setting:**\n- Consider n points on the unit sphere S² in R³\n- Optimal configurations maximize the product of pairwise distances (equivalently, minimize logarithmic energy)\n- These are called Fekete points in approximation theory\n- The question asks: do such optimal points distribute uniformly with respect to spherical caps?",
    "problemStatement": "**Problem Statement (Proved)**\n\nSuppose $A = \\{w_1, \\ldots, w_n\\} \\subset S^2$ maximizes $\\prod_{i<j} |w_i - w_j|$ over all sets of size $n$.\n\nIs it true that\n$$\\max_C ||A \\cap C| - \\alpha_C n| = o(n),$$\nwhere the maximum is over all spherical caps $C$ and $\\alpha_C$ is the normalized area of $C$?\n\n**Answer: YES**\n\nThe discrepancy grows sublinearly in $n$. Quantitative bounds:\n- Brauchart (2008): $\\ll n^{3/4}$\n- Wolff (unpublished) / Marzo-Mas (2021): $\\ll n^{2/3}$",
    "proofStrategy": "**Formalization Approach**\n\n1. **Geometric Setup:** Define the unit sphere S² as points in R³ at unit distance from origin, with chordal distance and spherical caps.\n\n2. **Energy Functions:** Define logarithmic energy E(A) = -log(∏|wᵢ - wⱼ|) and optimal configurations that minimize this energy (Fekete points).\n\n3. **Discrepancy Measure:** The spherical cap discrepancy measures how uniformly points are distributed: max over caps of ||A ∩ C| - αC·n|.\n\n4. **Main Results:** Axiomatize Brauchart's O(n^{3/4}) bound and Marzo-Mas's improved O(n^{2/3}) bound.\n\n5. **Qualitative Theorem:** The main erdos_991 theorem shows optimal configurations have small (o(n)) discrepancy.\n\n6. **Special Cases:** Hemisphere approximation and polar cap bounds as applications.",
    "keyInsights": [
      "**Logarithmic Energy:** Minimizing -log(∏|wᵢ - wⱼ|) spreads points as far apart as possible on the sphere",
      "**Fekete Points:** Optimal configurations are called Fekete points; they arise in polynomial interpolation on spheres",
      "**Discrepancy = Uniformity:** Small cap discrepancy means points distribute uniformly across all spherical regions",
      "**Classical Potential Theory:** The qualitative o(n) result follows from equidistribution theorems for Fekete points",
      "**Quantitative Improvement:** Marzo-Mas (2021) improves Brauchart's n^{3/4} to n^{2/3}, a factor of n^{1/12}",
      "**Riesz Generalization:** Logarithmic energy is the s → 0 limit of Riesz s-energy; results extend to general s"
    ]
  },
  "sections": [
    {
      "id": "unit-sphere",
      "title": "The Unit Sphere",
      "summary": "UnitSphere definition, sphereDist chordal distance",
      "startLine": 36,
      "endLine": 55
    },
    {
      "id": "logarithmic-energy",
      "title": "Logarithmic Energy",
      "summary": "logEnergy definition, IsOptimalConfig predicate for Fekete points",
      "startLine": 56,
      "endLine": 85
    },
    {
      "id": "spherical-caps",
      "title": "Spherical Caps",
      "summary": "SphericalCap, normalizedCapArea, capCount definitions",
      "startLine": 86,
      "endLine": 114
    },
    {
      "id": "discrepancy",
      "title": "Discrepancy",
      "summary": "SphericalCapDiscrepancy, HasSmallDiscrepancy property",
      "startLine": 115,
      "endLine": 139
    },
    {
      "id": "brauchart-bound",
      "title": "Brauchart's Bound (2008)",
      "summary": "brauchart_bound axiom: O(n^{3/4}) discrepancy",
      "startLine": 140,
      "endLine": 160
    },
    {
      "id": "marzo-mas-bound",
      "title": "Marzo-Mas Improvement (2021)",
      "summary": "marzo_mas_bound axiom: O(n^{2/3}) discrepancy",
      "startLine": 161,
      "endLine": 183
    },
    {
      "id": "main-theorem",
      "title": "Main Theorem (Erdős #991)",
      "summary": "erdos_991_qualitative, erdos_991 theorem",
      "startLine": 184,
      "endLine": 224
    },
    {
      "id": "related-concepts",
      "title": "Related Concepts",
      "summary": "FeketePoints, rieszEnergy, potential_theory_equidistribution",
      "startLine": 225,
      "endLine": 260
    },
    {
      "id": "special-cases",
      "title": "Special Cases",
      "summary": "hemisphere_approx, polar_cap_bound",
      "startLine": 261,
      "endLine": 297
    },
    {
      "id": "comparison-bounds",
      "title": "Comparison of Bounds",
      "summary": "improvement_factor, discrepancy_summary",
      "startLine": 298,
      "endLine": 332
    },
    {
      "id": "main-results",
      "title": "Main Results",
      "summary": "erdos_991_summary, erdos_991_answer",
      "startLine": 333,
      "endLine": 364
    }
  ],
  "conclusion": {
    "summary": "Erdős Problem #991 asked whether optimal logarithmic energy point configurations on the sphere have small cap discrepancy. The answer is YES: the discrepancy is o(n), meaning optimal points distribute uniformly in the limit. Brauchart (2008) gave the first quantitative bound of O(n^{3/4}), which Marzo-Mas (2021) improved to O(n^{2/3}).",
    "implications": "**Mathematical Connections**\n\n1. **Potential Theory:** Equidistribution of Fekete points is a classical result in logarithmic potential theory\n\n2. **Approximation Theory:** Fekete points are optimal for polynomial interpolation on spheres\n\n3. **Numerical Integration:** Low-discrepancy point sets give accurate quadrature rules on spheres\n\n4. **Riesz Energy:** Results extend to general Riesz s-energy, not just logarithmic (s → 0)\n\n5. **Higher Dimensions:** Similar questions can be asked for spheres in higher dimensions",
    "openQuestions": [
      "What is the optimal discrepancy exponent? Is O(n^{2/3}) tight?",
      "Can explicit constructions achieve the optimal discrepancy?",
      "How does the discrepancy depend on the dimension of the sphere?",
      "What is the discrepancy for other energy functionals (Riesz s-energy)?",
      "Connection to Problem #988 on related sphere packing questions"
    ]
  }
}
