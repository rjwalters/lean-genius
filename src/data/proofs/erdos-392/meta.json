{
  "id": "erdos-392",
  "title": "Erdős Problem #392: Optimal Factorization of n!",
  "slug": "erdos-392",
  "description": "Let A(n) be the minimum number of factors needed to write n! = a₁...aₜ with each aᵢ ≤ n². Then A(n) = n/2 - n/(2 log n) + o(n/log n).",
  "meta": {
    "author": "Cambie (2020s)",
    "sourceUrl": "https://erdosproblems.com/392",
    "date": "2020",
    "status": "complete",
    "proofRepoPath": "Proofs/Erdos392Problem.lean",
    "tags": [
      "erdos",
      "factorization",
      "factorial",
      "asymptotics",
      "number-theory"
    ],
    "badge": "wip",
    "sorries": 3,
    "erdosNumber": 392,
    "erdosUrl": "https://erdosproblems.com/392",
    "erdosProblemStatus": "solved",
    "dateAdded": "2026-01-17",
    "mathlib_version": "4.15.0",
    "mathlibDependencies": [
      {
        "theorem": "Nat.factorial",
        "description": "The factorial function n!",
        "module": "Mathlib.Data.Nat.Factorial.Basic"
      },
      {
        "theorem": "Asymptotics.isLittleO",
        "description": "Little-o asymptotic notation",
        "module": "Mathlib.Analysis.Asymptotics.Asymptotics"
      },
      {
        "theorem": "Filter.atTop",
        "description": "Filter for limits at infinity",
        "module": "Mathlib.Order.Filter.AtTopBot"
      },
      {
        "theorem": "Real.log",
        "description": "Natural logarithm on reals",
        "module": "Mathlib.Analysis.SpecialFunctions.Log.Basic"
      },
      {
        "theorem": "IsLeast",
        "description": "Predicate for least elements",
        "module": "Mathlib.Order.Bounds.Basic"
      }
    ],
    "originalContributions": [
      "Clean formalization of the optimal factorization problem for n!",
      "Definition of valid factorizations with monotonicity and bound constraints",
      "Statement of the main asymptotic A(n, n²) = n/2 - n/(2 log n) + o(n/log n)",
      "Statement of the variant with bound n: A(n, n) = n - n/log n + o(n/log n)",
      "Cambie's implication showing the main result follows from the variant",
      "Connection to Stirling's approximation for the lower bound intuition",
      "Verified small cases: A(2,4)=1, A(3,9)=1, A(4,16)=2, A(5,25)=2"
    ]
  },
  "overview": {
    "historicalContext": "Erdős Problem #392 asks about the most efficient way to express n! as a product of bounded factors. Given the constraint that each factor aᵢ ≤ n², what is the minimum number of factors needed?\n\nThe answer involves a beautiful interplay between Stirling's approximation and factor pairing. Stirling tells us log(n!) ≈ n log n, so if each factor is at most n², contributing at most 2 log n to the logarithm, we need roughly (n log n)/(2 log n) = n/2 factors.\n\nCambie observed that the problem with bound n² can be reduced to the variant with bound n via factor pairing. If a₁...aₜ = n! with each aᵢ ≤ n, define a'ᵢ = a₂ᵢ₋₁ · a₂ᵢ. Then each a'ᵢ ≤ n² and we have roughly t/2 factors. The variant with bound n is solved by a greedy algorithm: use n as often as possible, then n-1, and so on.",
    "problemStatement": "**Erdős Problem #392**: Let $A(n)$ denote the least value of $t$ such that\n$$n! = a_1 \\cdots a_t$$\nwith $a_1 \\leq \\cdots \\leq a_t \\leq n^2$. Is it true that\n$$A(n) = \\frac{n}{2} - \\frac{n}{2\\log n} + o\\left(\\frac{n}{\\log n}\\right)?$$\n\n**Status**: SOLVED\n\n**Answer**: YES. The formula is correct.\n\n**Variant**: With bound $a_t \\leq n$, we have $A(n) = n - n/\\log n + o(n/\\log n)$.",
    "proofStrategy": "Our formalization takes a structured approach:\n\n1. **Define valid factorizations**: A valid factorization of n! into t factors with bound B requires the product to equal n!, the sequence to be monotone increasing, and all factors bounded by B.\n\n2. **Axiomatize the minimum**: A(n, B) is the least t for which a valid factorization exists.\n\n3. **State the main theorem**: The asymptotic formula A(n, n²) = n/2 - n/(2 log n) + o(n/log n).\n\n4. **State the variant**: With bound n, we get A(n, n) = n - n/log n + o(n/log n).\n\n5. **Cambie's observation**: The main result follows from the variant by factor pairing.\n\n6. **Verify small cases**: We check A(2,4)=1, A(3,9)=1, A(4,16)=2, A(5,25)=2.",
    "keyInsights": [
      "**Factor bound tradeoff**: Larger bounds allow fewer factors. With bound n², roughly half as many factors are needed compared to bound n.",
      "**Stirling's role**: The asymptotic log(n!) ≈ n log n explains the leading n/2 term: (n log n)/(2 log n) = n/2.",
      "**Greedy optimality**: For bound n, a greedy algorithm is optimal: use n repeatedly, then n-1, etc. This gives the explicit formula.",
      "**Factor pairing**: Cambie's key insight - pairing consecutive factors a₂ᵢ₋₁·a₂ᵢ stays under n² and halves the count.",
      "**Correction term**: The -n/(2 log n) correction comes from the detailed structure of factorial primes."
    ]
  },
  "sections": [
    {
      "id": "header",
      "title": "Problem Documentation",
      "startLine": 1,
      "endLine": 26,
      "summary": "Problem statement, history, and Cambie's observation about factor pairing."
    },
    {
      "id": "valid-factorization",
      "title": "Valid Factorizations",
      "startLine": 42,
      "endLine": 62,
      "summary": "Defines IsValidFactorization and the minimum function A(n, B)."
    },
    {
      "id": "main-theorem",
      "title": "Main Result: Bound n²",
      "startLine": 64,
      "endLine": 84,
      "summary": "The main asymptotic: A(n, n²) = n/2 - n/(2 log n) + o(n/log n)."
    },
    {
      "id": "variant",
      "title": "Variant: Bound n",
      "startLine": 86,
      "endLine": 105,
      "summary": "With stricter bound n, we get A(n, n) = n - n/log n + o(n/log n)."
    },
    {
      "id": "cambie",
      "title": "Cambie's Observation",
      "startLine": 107,
      "endLine": 127,
      "summary": "The main result follows from the variant via factor pairing."
    },
    {
      "id": "stirling",
      "title": "Stirling's Approximation",
      "startLine": 129,
      "endLine": 155,
      "summary": "Connection to log(n!) ~ n log n and lower bound intuition."
    },
    {
      "id": "examples",
      "title": "Verified Examples",
      "startLine": 157,
      "endLine": 178,
      "summary": "Concrete values for small n: A(2,4)=1, A(3,9)=1, A(4,16)=2, A(5,25)=2."
    },
    {
      "id": "asymptotics",
      "title": "Asymptotic Behavior",
      "startLine": 180,
      "endLine": 196,
      "summary": "A(n, n²) ~ n/2 and the correction term is lower order."
    },
    {
      "id": "summary",
      "title": "Summary",
      "startLine": 198,
      "endLine": 220,
      "summary": "Key results and intuition packaged together."
    }
  ],
  "conclusion": {
    "summary": "We formalize Erdős Problem #392 on optimal factorization of n!. With factor bound n², the minimum number of factors is A(n) = n/2 - n/(2 log n) + o(n/log n). This follows from the variant with bound n via Cambie's factor pairing observation.",
    "implications": "This problem connects several areas:\n\n1. **Combinatorial number theory**: Factorizations of n! with constraints\n2. **Analytic number theory**: Stirling's approximation and prime factorization\n3. **Algorithmic aspects**: The greedy algorithm for the bound-n variant\n4. **Asymptotic analysis**: Little-o notation and error terms",
    "openQuestions": [
      "What is the exact constant in the error term o(n/log n)?",
      "Can the greedy algorithm be generalized to bound n²?",
      "What happens with other bounds like n^α for α ≠ 1, 2?",
      "Is there a closed form for A(n, n²) for small n?"
    ]
  }
}