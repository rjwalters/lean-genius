[
  {
    "id": "ann-e968-header",
    "proofId": "erdos-968",
    "range": { "startLine": 1, "endLine": 25 },
    "type": "concept",
    "title": "Problem Statement and History",
    "content": "**Erdos Problem #968** studies the 'normalized prime sequence' u_n = p_n/n, where p_n is the n-th prime. The question: does the set of n where u_n < u_{n+1} (increasing steps) have positive density?\n\nErdos and Prachar studied this in their 1961/62 paper 'Satze und Probleme uber p_k/k'. They proved that **decreasing steps have positive density**, but the increasing case remains **OPEN**.\n\n**The asymmetry puzzle**: Since increasing and decreasing steps partition N (up to a negligible 'flat' set), why is one case solved and the other open?",
    "mathContext": "By the Prime Number Theorem, p_n ~ n log n, so u_n = p_n/n ~ log n. The sequence grows slowly on average but oscillates due to irregularities in prime gaps.",
    "significance": "critical",
    "relatedConcepts": ["primes", "density", "erdos-prachar"]
  },
  {
    "id": "ann-e968-normalized-def",
    "proofId": "erdos-968",
    "range": { "startLine": 40, "endLine": 47 },
    "type": "definition",
    "title": "The Normalized Prime Sequence",
    "content": "**u(n)** = p_{n+1}/(n+1) is the normalized (n+1)-th prime. We use 0-based indexing:\n\n- u(0) = p_1/1 = 2/1 = 2\n- u(1) = p_2/2 = 3/2 = 1.5\n- u(2) = p_3/3 = 5/3 = 1.667\n\nBy PNT, p_n ~ n log n, so u(n) ~ log n. The sequence grows slowly (logarithmically) on average.",
    "mathContext": "Nat.nth Nat.Prime n returns the (n+1)-th prime in 0-based indexing. So nth Prime 0 = 2, nth Prime 1 = 3, etc. The division by (n+1) normalizes by the index.",
    "significance": "critical",
    "relatedConcepts": ["nth-prime", "normalization", "pnt"]
  },
  {
    "id": "ann-e968-density",
    "proofId": "erdos-968",
    "range": { "startLine": 49, "endLine": 57 },
    "type": "axiom",
    "title": "Natural Density",
    "content": "**Natural density** of a set S in N is lim_{n->inf} |{k <= n : k in S}|/n, when this limit exists.\n\nWe say S has **positive density** if this limit exists and is > 0. For example:\n- Even numbers have density 1/2\n- Primes have density 0\n- Perfect squares have density 0\n\nWe axiomatize Set.HasPosDensity since the formal definition requires decidability machinery.",
    "mathContext": "Formally, d(S) = lim_{n->inf} |S intersect [1,n]|/n. This is axiomatized as Set.HasPosDensity : Set N -> Prop to avoid the technical complexity of defining decidable density in Lean.",
    "significance": "key",
    "relatedConcepts": ["natural-density", "limit", "counting"]
  },
  {
    "id": "ann-e968-step-types",
    "proofId": "erdos-968",
    "range": { "startLine": 66, "endLine": 73 },
    "type": "definition",
    "title": "Step Types: Increasing, Decreasing, Flat",
    "content": "The normalized prime sequence can **increase, decrease, or stay flat** at each step:\n\n- **increasingSteps** = {n : u(n) < u(n+1)} - the ratio goes up\n- **decreasingSteps** = {n : u(n) > u(n+1)} - the ratio goes down\n- **flatSteps** = {n : u(n) = u(n+1)} - the ratio stays the same (rare)\n\nThese three sets partition N. The 'flat' set should be negligible since consecutive primes rarely give equal ratios.",
    "mathContext": "The condition u(n) < u(n+1) is equivalent to p_{n+1}/p_n > (n+1)/n, meaning the prime ratio exceeds the index ratio. This happens when prime gaps are 'large'.",
    "significance": "critical",
    "relatedConcepts": ["partition", "step-classification", "prime-gaps"]
  },
  {
    "id": "ann-e968-total-variation",
    "proofId": "erdos-968",
    "range": { "startLine": 79, "endLine": 88 },
    "type": "axiom",
    "title": "Erdos-Prachar: Total Variation",
    "content": "**Erdos-Prachar Theorem 1**: The total variation of the normalized prime sequence satisfies\n\nSum_{p_n < x} |u_{n+1} - u_n| = Theta((log x)^2)\n\nThis means the sequence oscillates **significantly** - the cumulative change is proportional to (log x)^2. If u_n were monotonic, total variation would be O(log x). The quadratic growth shows substantial back-and-forth movement.",
    "mathContext": "The notation f = Theta[atTop] g means f and g are asymptotically equivalent: there exist constants c_1, c_2 > 0 such that c_1*g(x) <= f(x) <= c_2*g(x) for large x. This is the 'theta' asymptotic notation.",
    "significance": "critical",
    "relatedConcepts": ["total-variation", "asymptotics", "oscillation"]
  },
  {
    "id": "ann-e968-decreasing-density",
    "proofId": "erdos-968",
    "range": { "startLine": 90, "endLine": 97 },
    "type": "axiom",
    "title": "Erdos-Prachar: Decreasing Steps Have Positive Density",
    "content": "**Erdos-Prachar Theorem 2**: The set of decreasing steps {n : u_n > u_{n+1}} has **positive natural density**.\n\nThis means a positive fraction of all n satisfy p_{n+1}/(n+1) < p_n/n. Intuitively, the normalized prime ratio often decreases because many prime gaps are 'small' relative to the expected log n.\n\nThis is the **solved half** of Problem #968.",
    "mathContext": "The proof uses sieve methods and careful analysis of prime gap distribution. The key insight is that small gaps (where p_{n+1} - p_n < log n) lead to decreasing steps, and these are sufficiently common.",
    "significance": "critical",
    "relatedConcepts": ["positive-density", "prime-gaps", "sieve-methods"]
  },
  {
    "id": "ann-e968-open-question",
    "proofId": "erdos-968",
    "range": { "startLine": 105, "endLine": 116 },
    "type": "axiom",
    "title": "The Open Question: Increasing Steps",
    "content": "**Erdos Problem #968 (OPEN)**: Does the set of increasing steps {n : u_n < u_{n+1}} have positive natural density?\n\nThis is the **unsolved twin** of the decreasing case. The puzzle:\n- Since increasing union decreasing union flat = N\n- And flat is presumably measure zero\n- Why doesn't the decreasing result imply the increasing result?\n\nThe answer involves subtle asymmetries in prime gap distribution.",
    "mathContext": "We state erdos_968_open : Prop as an unknown axiom. The condition u(n) < u(n+1) is equivalent to prime gap p_{n+1} - p_n > u(n) ~ log n, i.e., gaps exceeding the 'expected' log n.",
    "significance": "critical",
    "relatedConcepts": ["open-problem", "density-question", "gap-threshold"]
  },
  {
    "id": "ann-e968-triples",
    "proofId": "erdos-968",
    "range": { "startLine": 124, "endLine": 140 },
    "type": "concept",
    "title": "Increasing and Decreasing Triples",
    "content": "**Related Open Questions**: Are there infinitely many n with:\n\n- **Increasing triples**: u_n < u_{n+1} < u_{n+2} (three consecutive increases)\n- **Decreasing triples**: u_n > u_{n+1} > u_{n+2} (three consecutive decreases)\n\nThese require stronger structure than single steps - the sequence must maintain its direction for two consecutive steps. Both questions remain **OPEN**.",
    "mathContext": "An increasing triple requires two consecutive 'large' prime gaps (both exceeding log n). A decreasing triple requires two consecutive 'small' gaps. The independence or correlation of consecutive gaps is not well understood.",
    "significance": "key",
    "relatedConcepts": ["triples", "consecutive-gaps", "correlation"]
  },
  {
    "id": "ann-e968-pnt-connection",
    "proofId": "erdos-968",
    "range": { "startLine": 148, "endLine": 155 },
    "type": "axiom",
    "title": "Prime Number Theorem Connection",
    "content": "**PNT implies**: u(n) ~ log n as n -> infinity.\n\nBy the Prime Number Theorem, p_n ~ n log n. Dividing by n:\n\nu_n = p_n/n ~ log n\n\nSo the normalized sequence grows **logarithmically** on average. The oscillations around this trend are what Erdos-Prachar studied.",
    "mathContext": "The axiom u_asymptotic_log states: for all epsilon > 0, eventually |u(n) - log n| < epsilon * log n. This is the standard epsilon-delta formulation of u(n) ~ log n.",
    "significance": "key",
    "relatedConcepts": ["pnt", "asymptotic", "logarithmic-growth"]
  },
  {
    "id": "ann-e968-prime-axioms",
    "proofId": "erdos-968",
    "range": { "startLine": 163, "endLine": 170 },
    "type": "axiom",
    "title": "Prime Value Axioms",
    "content": "We axiomatize the first few primes for verified computations:\n\n- **first_prime**: Nat.nth Prime 0 = 2\n- **second_prime**: Nat.nth Prime 1 = 3\n- **third_prime**: Nat.nth Prime 2 = 5\n\nThese are axioms because Nat.nth is noncomputable in Lean (it uses classical logic), so native_decide cannot evaluate them.",
    "mathContext": "Nat.nth p n returns the n-th element satisfying predicate p. For p = Nat.Prime, it gives primes in order: 2, 3, 5, 7, 11, ... The function is noncomputable because primality testing uses Decidable instances that aren't definitionally computable.",
    "significance": "supporting",
    "relatedConcepts": ["nth-element", "prime-sequence", "axiomatization"]
  },
  {
    "id": "ann-e968-u-values",
    "proofId": "erdos-968",
    "range": { "startLine": 172, "endLine": 185 },
    "type": "theorem",
    "title": "Verified Values: u(0), u(1), u(2)",
    "content": "We compute the first three values of the normalized sequence:\n\n- **u_zero**: u(0) = 2/1 = 2\n- **u_one**: u(1) = 3/2 = 1.5\n- **u_two**: u(2) = 5/3 = 1.667\n\nNotice: 2 > 1.5 < 1.667, so the sequence **decreases then increases** at the start.",
    "mathContext": "The proofs use simp to unfold the definition, apply the prime axioms, and then norm_num to verify the arithmetic. The results are exact rational values.",
    "significance": "key",
    "relatedConcepts": ["concrete-values", "computation", "norm-num"]
  },
  {
    "id": "ann-e968-first-steps",
    "proofId": "erdos-968",
    "range": { "startLine": 187, "endLine": 201 },
    "type": "theorem",
    "title": "Classification of First Steps",
    "content": "**first_step_decreasing**: u(0) > u(1), so 0 is in decreasingSteps\n\n**second_step_increasing**: u(1) < u(2), so 1 is in increasingSteps\n\nThis shows both step types occur early! The sequence starts: 2 -> 1.5 -> 1.667 -> ...\n\nThe first step is decreasing because 2 > 1.5. The second step is increasing because 1.5 < 1.667.",
    "mathContext": "The proofs use the computed values u_zero, u_one, u_two and then norm_num to verify the inequalities 2 > 3/2 and 3/2 < 5/3.",
    "significance": "key",
    "relatedConcepts": ["step-classification", "examples", "decreasing-step"]
  },
  {
    "id": "ann-e968-gap-condition",
    "proofId": "erdos-968",
    "range": { "startLine": 220, "endLine": 222 },
    "type": "theorem",
    "title": "Increasing Steps and Prime Gaps",
    "content": "**increasing_iff_gap_large**: n in increasingSteps iff u(n) < u(n+1)\n\nThis is definitionally true (Iff.rfl). The deeper insight in the comments:\n\nu_{n+1} > u_n iff p_{n+1}/(n+1) > p_n/n iff prime gap > u_n ~ log n\n\nSo **increasing steps happen when prime gaps exceed the expected log n**.",
    "mathContext": "The equivalence p_{n+1}/(n+1) > p_n/n can be rearranged to (n+1)*p_n < n*p_{n+1}, which gives p_{n+1} - p_n > p_n/n = u_n. Since u_n ~ log n, large gaps cause increases.",
    "significance": "key",
    "relatedConcepts": ["gap-analysis", "threshold", "log-n"]
  },
  {
    "id": "ann-e968-summary",
    "proofId": "erdos-968",
    "range": { "startLine": 245, "endLine": 247 },
    "type": "theorem",
    "title": "Summary Theorem",
    "content": "**erdos_968_summary** packages our main results:\n\n1. 0 is in decreasingSteps (first step is decreasing)\n2. 1 is in increasingSteps (second step is increasing)\n3. decreasingSteps has positive density (Erdos-Prachar)\n\nThis demonstrates concrete examples AND the known density result, while the increasing density question remains open.",
    "mathContext": "The proof is (zero_in_decreasing, one_in_increasing, erdos_prachar_decreasing_density) - a triple combining our verified examples with the axiomatized Erdos-Prachar theorem.",
    "significance": "supporting",
    "relatedConcepts": ["summary", "conjunction", "main-result"]
  }
]
