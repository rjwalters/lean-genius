[
  {
    "id": "ann-e1003-header",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 1,
      "endLine": 18
    },
    "type": "concept",
    "title": "Problem Overview",
    "content": "**Erdős Problem #1003** asks: Are there infinitely many n with φ(n) = φ(n+1)?\n\nThe Euler totient function φ(n) counts integers from 1 to n that are coprime to n. The question is whether consecutive integers can have equal totient values infinitely often.\n\n**Status**: OPEN — The conjecture is believed true but unproved.",
    "mathContext": "Known solutions form OEIS A001274: 1, 3, 15, 104, 164, 194, 255, ... The sequence appears infinite computationally, but a proof remains elusive.",
    "significance": "critical",
    "relatedConcepts": [
      "Euler totient function",
      "consecutive integers",
      "infinite sets"
    ]
  },
  {
    "id": "ann-e1003-imports",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 20,
      "endLine": 26
    },
    "type": "concept",
    "title": "Mathlib Imports",
    "content": "We import:\n- **Nat.Totient**: Euler's totient function φ\n- **Set.Finite.Basic**: Predicates for infinite sets\n- **Filter.AtTopBot**: The 'eventually' quantifier for asymptotic statements\n- **SpecialFunctions.Pow.Real**: Real exponentiation for bounds\n- **SpecialFunctions.Log.Basic**: Logarithms for the EPS bound",
    "significance": "supporting",
    "relatedConcepts": [
      "Mathlib",
      "totient function",
      "asymptotic analysis"
    ]
  },
  {
    "id": "ann-e1003-totient-bg",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 28,
      "endLine": 42
    },
    "type": "concept",
    "title": "Euler Totient Background",
    "content": "The **Euler totient function** φ(n) satisfies:\n\n- φ(1) = 1\n- φ(p) = p - 1 for prime p\n- φ(p^k) = p^(k-1)(p - 1) for prime power\n- φ(mn) = φ(m)φ(n) when gcd(m,n) = 1\n\nThese properties determine φ completely via prime factorization.",
    "mathContext": "For consecutive n and n+1, we have gcd(n, n+1) = 1 always. So their totients depend on completely disjoint prime factorizations, making equal values surprising.",
    "significance": "key",
    "relatedConcepts": [
      "multiplicative function",
      "prime factorization",
      "coprimality"
    ]
  },
  {
    "id": "ann-e1003-when-equal",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 43,
      "endLine": 56
    },
    "type": "concept",
    "title": "When Can φ(n) = φ(n+1)?",
    "content": "For φ(n) = φ(n+1) to hold, the prime factorizations must **conspire** to produce equal products.\n\n**Examples**:\n- n = 1: φ(1) = 1, φ(2) = 1 ✓\n- n = 3: φ(3) = 2, φ(4) = 2 ✓  \n- n = 15: φ(15) = 8, φ(16) = 8 ✓\n- n = 104: φ(104) = 48, φ(105) = 48 ✓",
    "mathContext": "A common pattern: powers of 2 (which have totient 2^(k-1)) matching products of small primes. For instance, φ(16) = 8 = φ(15) = φ(3)φ(5) = 2×4.",
    "significance": "key",
    "relatedConcepts": [
      "prime factorization",
      "totient computation",
      "numerical coincidences"
    ]
  },
  {
    "id": "ann-e1003-solution-set",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 57,
      "endLine": 63
    },
    "type": "definition",
    "title": "The Solution Set",
    "content": "**ConsecutiveEqualTotients** is the set of n where φ(n) = φ(n+1):\n\n```\ndef ConsecutiveEqualTotients : Set ℕ :=\n  { n : ℕ | φ n = φ (n + 1) }\n```\n\nThe main conjecture states this set is infinite.",
    "mathContext": "Using Mathlib's native Nat.totient (denoted φ in the open Nat namespace), the set membership is decidable for any specific n.",
    "significance": "critical",
    "relatedConcepts": [
      "set builder notation",
      "decidability",
      "totient function"
    ]
  },
  {
    "id": "ann-e1003-conjecture",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 64,
      "endLine": 79
    },
    "type": "definition",
    "title": "The Main Conjecture",
    "content": "**erdos_1003_conjecture** is the proposition that ConsecutiveEqualTotients is infinite:\n\n```\ndef erdos_1003_conjecture : Prop := \n  ConsecutiveEqualTotients.Infinite\n```\n\nThis remains an OPEN problem despite extensive computational evidence.",
    "significance": "critical",
    "relatedConcepts": [
      "Set.Infinite",
      "open conjecture",
      "asymptotic behavior"
    ]
  },
  {
    "id": "ann-e1003-verified-examples",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 80,
      "endLine": 116
    },
    "type": "lemma",
    "title": "Verified Examples",
    "content": "We verify small solutions using **native_decide**:\n\n| n | φ(n) | φ(n+1) | Verification |\n|---|------|--------|-------------|\n| 1 | 1 | 1 | `native_decide` |\n| 3 | 2 | 2 | `native_decide` |\n| 15 | 8 | 8 | `native_decide` |\n| 104 | 48 | 48 | `native_decide` |\n\nThese confirm membership in ConsecutiveEqualTotients.",
    "mathContext": "The native_decide tactic computes φ using Mathlib's implementation and checks equality. This provides machine-verified confirmation of each example.",
    "significance": "supporting",
    "relatedConcepts": [
      "native_decide",
      "computational verification",
      "OEIS A001274"
    ]
  },
  {
    "id": "ann-e1003-k-consecutive",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 117,
      "endLine": 136
    },
    "type": "definition",
    "title": "Consecutive k Equal Values",
    "content": "**ConsecutiveKEqualTotients(k)** is the set where k+1 consecutive totients are equal:\n\n```\ndef ConsecutiveKEqualTotients (k : ℕ) : Set ℕ :=\n  { n : ℕ | ∀ i ≤ k, φ n = φ (n + i) }\n```\n\n**Erdős's Stronger Conjecture**: For every k ≥ 1, this set is infinite.",
    "mathContext": "The k = 0 case is trivially true (every n satisfies φ(n) = φ(n)). The k = 1 case is the main conjecture. The k = 2 case (triples) is known to have solutions like n = 5186.",
    "significance": "key",
    "relatedConcepts": [
      "generalization",
      "consecutive values",
      "uniform bounds"
    ]
  },
  {
    "id": "ann-e1003-eps-bound",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 137,
      "endLine": 163
    },
    "type": "axiom",
    "title": "Erdős-Pomerance-Sárközy Upper Bound",
    "content": "**EPS [1987]** proved: the count of n ≤ x with φ(n) = φ(n+1) is at most:\n\n$$\\frac{x}{\\exp((\\log x)^{1/3})}$$\n\nThis is a **strong sparsity result**. Even if infinite, solutions are very rare.\n\nFor x = 10^6: bound ≈ 10^6 / e^10 ≈ 45 solutions (actual: ~25)",
    "mathContext": "The bound exp((log x)^(1/3)) grows faster than any polynomial in log x but slower than any power of x. This is sometimes written as x/exp((log x)^(1/3+o(1))).",
    "significance": "key",
    "relatedConcepts": [
      "asymptotic density",
      "upper bound",
      "Erdős-Pomerance-Sárközy"
    ]
  },
  {
    "id": "ann-e1003-oeis",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 164,
      "endLine": 179
    },
    "type": "concept",
    "title": "OEIS A001274",
    "content": "The sequence of n where φ(n) = φ(n+1) begins:\n\n1, 3, 15, 104, 164, 194, 255, 495, 584, 975, 2204, 2625, 2834, 3255, 3705, **5186, 5187**, 10604, 11715, 13365, ...\n\nNote: **5186 and 5187** are consecutive members, meaning φ(5186) = φ(5187) = φ(5188). This is a triple!",
    "significance": "supporting",
    "relatedConcepts": [
      "OEIS",
      "computed examples",
      "consecutive members"
    ]
  },
  {
    "id": "ann-e1003-carmichael",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 180,
      "endLine": 201
    },
    "type": "concept",
    "title": "Connection to Carmichael's Conjecture",
    "content": "**Carmichael's Totient Conjecture**: Every value in the range of φ is achieved at least twice.\n\nIn Lean:\n```\ndef carmichael_totient_conjecture : Prop :=\n  ∀ n ≥ 1, ∃ m, m ≠ n ∧ φ m = φ n\n```\n\nThis is also OPEN and would imply that totient values have 'multiplicity'.",
    "mathContext": "If every totient value appears at least twice, consecutive equal values become more plausible. The two conjectures are related but neither implies the other directly.",
    "significance": "supporting",
    "relatedConcepts": [
      "Carmichael conjecture",
      "totient valence",
      "open problems"
    ]
  },
  {
    "id": "ann-e1003-understanding-15-16",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 202,
      "endLine": 227
    },
    "type": "concept",
    "title": "Why φ(15) = φ(16)",
    "content": "**The 15/16 coincidence**:\n\n- 15 = 3 × 5 → φ(15) = (3-1)(5-1) = 2 × 4 = **8**\n- 16 = 2⁴ → φ(16) = 2³ = **8**\n\nThe product of (p-1) for small primes 3 and 5 equals the power of 2 from 16.\n\nThis pattern recurs: powers of 2 often match products of small odd primes.",
    "mathContext": "More generally, φ(2^k) = 2^(k-1). To match this with φ(2^k - 1), we need the factorization of 2^k - 1 to produce 2^(k-1) as a product of (p-1) terms.",
    "significance": "supporting",
    "relatedConcepts": [
      "Mersenne numbers",
      "totient formula",
      "numerical patterns"
    ]
  },
  {
    "id": "ann-e1003-understanding-104-105",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 228,
      "endLine": 237
    },
    "type": "concept",
    "title": "Why φ(104) = φ(105)",
    "content": "**The 104/105 coincidence**:\n\n- 104 = 2³ × 13 → φ(104) = 4 × 12 = **48**\n- 105 = 3 × 5 × 7 → φ(105) = 2 × 4 × 6 = **48**\n\nHere a prime power (2³) paired with prime 13 matches a product of three small primes.",
    "significance": "supporting",
    "relatedConcepts": [
      "totient computation",
      "prime factorization",
      "numerical coincidences"
    ]
  },
  {
    "id": "ann-e1003-triple",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 238,
      "endLine": 260
    },
    "type": "axiom",
    "title": "The Consecutive Triple",
    "content": "**Remarkable fact**: φ(5186) = φ(5187) = φ(5188) = 1728\n\n- 5186 = 2 × 2593 → φ = 1 × 2592 = 2592... wait, let me recompute\n- Actually: 5186 = 2 × 2593 (2593 prime) → φ = 1 × 2592\n\nThe exact factorizations:\n- 5186 = 2 × 2593\n- 5187 = 3 × 7 × 13 × 19\n- 5188 = 2² × 1297",
    "mathContext": "Three consecutive integers with equal totient is much rarer than pairs. The existence of such triples supports the stronger Erdős conjecture for k = 2.",
    "significance": "key",
    "relatedConcepts": [
      "consecutive triples",
      "rare coincidences",
      "stronger conjecture"
    ]
  },
  {
    "id": "ann-e1003-flp-bound",
    "proofId": "erdos-1003",
    "range": {
      "startLine": 261,
      "endLine": 280
    },
    "type": "axiom",
    "title": "Ford-Luca-Pomerance Lower Bound",
    "content": "**FLP [2007]** proved: for any ε > 0, eventually the count of solutions up to x exceeds x^(1-ε).\n\n```\naxiom flp_lower_bound (ε : ℝ) (hε : 0 < ε) :\n    ∀ᶠ x : ℕ in atTop, (x : ℝ) ^ (1 - ε) ≤ \n      (countConsecutiveEqual x : ℝ)\n```\n\nThis would imply infinitely many solutions, effectively settling the conjecture.",
    "mathContext": "If true unconditionally, this gives a lower bound of x^(1-o(1)) which combined with the EPS upper bound of x^(1-o(1)) means the count grows almost like x, contradicting itself. The actual bounds are more subtle.",
    "significance": "key",
    "relatedConcepts": [
      "lower bound",
      "Ford-Luca-Pomerance",
      "asymptotic growth"
    ]
  }
]
